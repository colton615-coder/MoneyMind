<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>PennyPilot — Personal Finance</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<meta name="theme-color" content="#0B1020" />
<link rel="manifest" href="manifest.webmanifest">
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='256' height='256' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='56' fill='%2310162A'/%3E%3Ctext x='50%25' y='54%25' text-anchor='middle' dominant-baseline='middle' font-family='Inter,Arial' font-weight='700' font-size='120' fill='%2334d399'%3E%24%3C/text%3E%3C/svg%3E" />
<link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='512' height='512' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='56' fill='%2310162A'/%3E%3Ctext x='50%25' y='54%25' text-anchor='middle' dominant-baseline='middle' font-family='Inter,Arial' font-weight='700' font-size='120' fill='%2334d399'%3E%24%3C/text%3E%3C/svg%3E" />
<script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
  :root{
    --bg:#0B1020; --card:#111827; --ink:#E6EAF3; --sub:#9AA6C7;
    --muted:#1D2A4C; --accent:#34D399; --accent2:#60A5FA;
    --warn:#F59E0B; --danger:#EF4444; --shadow:0 10px 30px rgba(0,0,0,.35);
    --radius:18px;
  }
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.4 Inter,system-ui,sans-serif;padding-bottom:92px}
  header{position:sticky;top:0;z-index:10;background:#0e1627;padding:16px;text-align:center}
  header h1{margin:0;font-size:20px;font-weight:800;color:var(--accent)}
  main{max-width:980px;margin:0 auto;padding:16px}
  section{background:var(--card);border:1px solid var(--muted);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;margin:12px 0}
  h2{margin-top:0;font-size:18px}
  label{display:block;font-size:13px;color:var(--sub);margin-bottom:6px}
  input,select{width:100%;padding:10px;border-radius:10px;border:1px solid var(--muted);background:#0f172a;color:var(--ink)}
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px;border-bottom:1px solid var(--muted);text-align:left}
  th{color:#9fb2dd}
  nav{position:fixed;bottom:0;left:0;right:0;background:#0e1627;border-top:1px solid #1b2540;display:flex}
  nav button{flex:1;background:none;border:0;padding:10px;color:#9ca3af;font-size:14px}
  nav button.active{color:var(--accent);font-weight:700}
</style>
</head>
<body>
<header><h1>PennyPilot</h1></header>
<main>  <!-- Home -->
  <section id="home">
    <h2>Today</h2>
    <div>
      <strong>Spent today:</strong> <span id="todaySpend">$0.00</span><br>
      <strong>This month:</strong> <span id="monthSpend">$0.00</span><br>
      <strong>Under / Over:</strong> <span id="deltaSpend">$0.00</span>
    </div>
    <canvas id="trend" height="160" style="margin-top:12px"></canvas>
  </section>

  <!-- Log -->
  <section id="log">
    <h2>Log Expense</h2>
    <label>Amount</label>
    <input id="amount" inputmode="decimal" placeholder="e.g., 12.50">
    <label>Category / Subcategory</label>
    <select id="category"></select>
    <label>Date</label>
    <input id="date" type="date">
    <label>Note</label>
    <input id="note" placeholder="optional note">
    <button onclick="saveTx()">Save Expense</button>
  </section>  <!-- Budgets -->
  <section id="budgets">
    <h2>Budgets</h2>
    <table id="budgetTable">
      <thead>
        <tr><th>Category</th><th>Budget</th><th>Spent</th><th>%</th><th>Status</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <label>Add / Update Category</label>
    <input id="newCat" placeholder="Category name">
    <input id="newBudget" inputmode="decimal" placeholder="Budget">
    <button onclick="addOrUpdateCat()">Save Budget</button>
  </section>

  <!-- Reports -->
  <section id="reports">
    <h2>Reports</h2>
    <canvas id="donut" height="200"></canvas>
    <h3>Transactions</h3>
    <table id="txTable">
      <thead>
        <tr><th>Date</th><th>Category</th><th>Amount</th><th>Note</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>
</main>

<nav>
  <button onclick="showView('home')" class="active">Home</button>
  <button onclick="showView('log')">Log</button>
  <button onclick="showView('budgets')">Budgets</button>
  <button onclick="showView('reports')">Reports</button>
</nav><script>
let cats = JSON.parse(localStorage.getItem('cats')||'["Groceries","Dining","Transport","Misc"]');
let budgets = JSON.parse(localStorage.getItem('budgets')||'{}');
let txs = JSON.parse(localStorage.getItem('txs')||'[]');

function saveTx(){
  const amt = parseFloat(document.getElementById('amount').value||0);
  const cat = document.getElementById('category').value;
  const date = document.getElementById('date').value;
  const note = document.getElementById('note').value;
  if(!(amt>0)) return alert("Enter valid amount");
  txs.push({amt,cat,date,note});
  localStorage.setItem('txs',JSON.stringify(txs));
  render(); alert("Saved!");
}

function addOrUpdateCat(){
  const name=document.getElementById('newCat').value.trim();
  const b=parseFloat(document.getElementById('newBudget').value||0);
  if(!name||isNaN(b)) return;
  if(!cats.includes(name)) cats.push(name);
  budgets[name]=b;
  localStorage.setItem('cats',JSON.stringify(cats));
  localStorage.setItem('budgets',JSON.stringify(budgets));
  render();
}

function render(){
  document.getElementById('category').innerHTML = cats.map(c=>`<option>${c}</option>`).join('');
  const tbody=document.querySelector('#txTable tbody');
  tbody.innerHTML=txs.map(t=>`<tr><td>${t.date}</td><td>${t.cat}</td><td>$${t.amt.toFixed(2)}</td><td>${t.note||""}</td></tr>`).join('');
  const spentBy={}; cats.forEach(c=>spentBy[c]=0);
  txs.forEach(t=>spentBy[t.cat]+=t.amt);
  const btbody=document.querySelector('#budgetTable tbody');
  btbody.innerHTML=cats.map(c=>{
    const b=budgets[c]||0; const s=spentBy[c]||0; const pct=b?((s/b)*100).toFixed(0)+"%":"—";
    const status=b? (s<b*0.75?"OK":(s<=b?"Warning":"Over
